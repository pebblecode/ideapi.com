# Installation 

To install ideapi from scratch, first clone the source from apu:
    
    git clone git@apu.pebbleit.com:ideapi.com.git

    # Ideapi uses redis so install it through homebrew. If you need to install homebrew
    # follow instructions here: https://github.com/mxcl/homebrew
    brew update
    brew install redis    # Follow post install instructions

    # If you don't have mysql installed 
    brew install mysql
    
    # Change to the directory where you downloaded the ideapi source  
    bundle install # you may need to use `sudo bundle install` depending on your setup

    # Create a database.yml file with relevant account in mysql
        
    # Set up db
    rake db:create    # Required if ideapi db hasn't been created yet
    rake ideapi:bootstrap
    
    
Add this to the /etc/apache2/extra/httpd-vhosts.conf file, replacing [ideapi directory] with the relevant value:
    
    <VirtualHost *:80>
        <Directory [ideapi directory]>
          Options +FollowSymlinks +SymLinksIfOwnerMatch 
          Order allow,deny
          allow from all
          AllowOverride All
        </Directory>
        DocumentRoot [ideapi directory]/public
        ServerName smackaho.st
        ServerAlias *.smackaho.st
        RailsEnv development
    </VirtualHost>
    
## Resque    

ideapi makes use of Resque http://github.com/defunkt/resque to queue background jobs. Resque relies on Redis. 
The Resque README provides instructions on installing Redis.

To ensure that workers do not die (bless them) ideapi also uses monit. The staging and 
production servers are configured to keep workers and Redis alive.

On your development box you will need to have Redis and workers running if you want to use Resque and send email.

To invoke a worker from the root of the rails site you can use the following command

    QUEUE=* rake resque:work

To start the Resque GUI run

    resque-web -p 8282 config/initializers/load_resque.rb 

This shows you workers running and any problems with the jobs you send them. 

If you are not running Redis as a daemon, you can start it with 

    redis-server /usr/local/etc/redis.conf

## Gotchas

### http://smackaho.st/ redirects to 404 page

Clear the browser cache. Could occur when you log into ideapi, and then clear out the database. An issue with the cookies.

### ActionController::InvalidAuthenticityToken error when logging in/signing up

Check config/environments/development.rb variable is the same as the url eg,

  config.action_controller.session = { :domain => ".smackaho.st" }
  
for the *.smackaho.st domain.




